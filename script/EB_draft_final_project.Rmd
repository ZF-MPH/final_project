---
title: "final_project_mkdn"
author: "Zach F"
date: "11/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Join Data
Datasets were **joined** (demographics dataset and physical activity dataset)
```{r}
library(tidyverse)
library(rio)
library(here)
library(janitor)
library(tidyr)
library(dplyr)
library(readr)
demographics <- import(here("data", "Teen-Demographic-SPSS(1) copy.zip"))

phys_act <- import(here("data", "Teen-PA-SPSS(1) copy.zip"))

# joined demographics and PA-questionnaire by participant ID "PID"
joined_set <- demographics %>% full_join(phys_act, by = "PID")


# selecting only variables that we may use
selected_variables <- joined_set %>% 
  select(TAGE, TGRADE, TSEX, TSCHLTYPE, XTHEIGHTCM_RC, XTWEIGHTKG_RC, TETHRAC_RC, TPMPABAD, TPMPAWANT, TPMPAUPST, TPMPAIMPT, XTPREDWEEKS, XTPREDWEEKOFS, XTPREDWEEKW)
```

## Filter and Mutate
We **filtered** to only show _high school respondents_ & then used **mutate()**
to create a column for BMI (calculated from height/weight
```{r}
highschool_only <- selected_variables %>% 
  filter(TAGE >= 14 | TAGE < 18) %>% 
  filter(!is.na(TAGE))

HS_W_BMI <- highschool_only %>% 
  mutate(Height_M = XTHEIGHTCM_RC / 100) %>% 
  mutate(BMI = XTWEIGHTKG_RC/(Height_M^2)) %>%
  mutate(total_PA = XTPREDWEEKS + XTPREDWEEKOFS + XTPREDWEEKW)
```

## Commit 3
```{r}
HS_W_BMI %>%
  group_by(TSCHLTYPE, TSEX) %>%
  summarize(mean_age = mean(TAGE), mean_total_PA= mean(total_PA, na.rm= TRUE))
#come back to this to get rid of the -9

longer_hs <- highschool_only %>% 
  pivot_longer(
    cols = starts_with("XTPREDWEEK"), 
    names_to = "MVPA(source)", 
    values_to = "minutes", 
    values_drop_na = TRUE)
    
  wider_hs <- highschool_only %>%
    pivot_wider(
     names_from = c(TGRADE,TSEX), 
     values_from = XTPREDWEEKS,
     values_fn = list(XTPREDWEEKS = mean))
  
  wider_hs2 <- highschool_only %>%
    pivot_wider(
      names_from = TSEX, 
      values_from = c(TGRADE, TAGE)
    )
  
  #mean weekly minutes of exercise at school for each combination of grade and sex
  #need to remove the NA- 
  


# next up: pivot_wider and pivot_longer
```

